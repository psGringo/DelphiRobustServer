unit uCommandGet;

interface

uses
  System.SysUtils, System.Classes, IdContext, IdCustomHTTPServer, System.Generics.Collections,
  superobject;

type
  TCommandGet = class(TComponent)
  public
    procedure Execute(AContext: TIdContext; ARequestInfo: TIdHTTPRequestInfo; AResponseInfo: TIdHTTPResponseInfo);
  end;

implementation

uses
  uResponses,uSmartPointer,
  uRPUsers;

  { TCommandGet }
procedure TCommandGet.Execute(AContext: TIdContext; ARequestInfo: TIdHTTPRequestInfo; AResponseInfo: TIdHTTPResponseInfo);
 procedure Do123();
 begin

 end;
var
  json: ISuperObject;
  r: IResponses;
  d, a, b: Double;
  uri: string;
  users :IRPUsers;
begin
  r := TResponses.Create(ARequestInfo, AResponseInfo);
  try
    uri := ARequestInfo.URI;
    // processRequest('testConnection') // to this view...
    if uri = '/Test/Connection' then
    r.OK()
    else if uri = '/Test/Exception' then
    begin
      a := 1;
      b := 0;
      d := a / b;
    end
    else if uri.contains('Users') then
    begin
      users := TRPUsers.Create(ARequestInfo, AResponseInfo);
      if uri = '/Users/Add' then
        users.Add;
    end
    else
      AResponseInfo.ResponseNo := 404;
  except
    on E: Exception do
      r.Error(e.Message);
  end;
end;

end.

